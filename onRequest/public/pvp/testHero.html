<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>测试英雄</title>
    <style>
        .test{
            margin-left: 2%;
        }
        .dialog{
            position: fixed;
            left:0;
            top:0;
            display: none;
            width: 100%;
            height: 100%;
            background-color: darkgray;
        }
        .show{
            display: block;
        }
        .dialogContainer{
            margin: 5% 2% 2% 2%;
            /*width: 80%;*/
            height: 85%;
            overflow: scroll;
            background-color: white;
        }
        .dialogCloseBtn{
            float:right;
            margin-right: 5%;
        }
    </style>
    <script src="../js/library/jquery-3.3.1.min.js"></script>
    <script src="../js/util/file.js"></script>
</head>
<body style="font-size: 16px">
<!--<p>选项卡  /spider/getPvpTabs</p>-->
<!--<img src="/onRequest/public/images/pvp/tabs.jeg"/ >-->
<h3>header头务必设置x-requested-with（不区分大小写，推荐X-Requested-With），
    值为XMLHttpRequest（固定值，区分大小写），否则返回的数据不是json格式
</h3>
<p>
    获取 英雄单选框数据
    <span class="testUrl">
        /<span class="controller">pvp</span>/<span>getHeroSearchRadios</span>
    </span>
    <a href="" target="_blank" class="test">测试</a>
</p>
<img src="/onRequest/public/images/pvp/heroRadios.png?v=2" alt=""/>
<p>方式 GET , 无需参数</p>
<p>返回数据：json格式的字符串</p>
<pre>
[
    {
        "id": "1",
        "radio_text": "本周免费",
        "data_p_type": "10",
        "data_type": null
    },
    {
        "id": "2",
        "radio_text": "新手推荐",
        "data_p_type": "11",
        "data_type": null
    },
    {
        "id": "3",
        "radio_text": "全部",
        "data_p_type": null,
        "data_type": "0"
    },
</pre>
<hr/>
<p>英雄列表
    <span class="testUrl">
        /<span class="controller">pvp</span>/<span>getHeroesList</span>
    </span>
    <a href="" target="_blank" class="test">测试</a>
</p>
<table cellpadding="10" cellspacing="0" border="1">
    <caption>参数</caption>
    <thead>
    <tr>
        <th>参数</th>
        <th>是否必需</th>
        <th>参数名</th>
        <th>类型</th>
        <th>解释</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>页码</td>
        <td>非必需</td>
        <td>p</td>
        <td>Integer</td>
        <td>需要第p页的列表数据</td>
    </tr>
    <tr>
        <td>每页条数</td>
        <td>非必需</td>
        <td>pageSize</td>
        <td>Integer</td>
        <td>每页显示pageSize条数据，默认10条</td>
    </tr>
    <tr>
        <td>英雄类型</td>
        <td>非必需</td>
        <td>hero_type</td>
        <td>int</td>
        <td>
            值和解释如下
            <pre>
        0,//全部
        3,//坦克
        1,//战士
        4,//刺客
        2,//法师
        5,//射手
        6,//辅助
        7,//新手推荐
        8,//本周免费
        </pre>
        </td>
    </tr>
    <tr>
        <td>英雄名称关键字</td>
        <td>非必须</td>
        <td>hero_name</td>
        <td>string</td>
        <td>优先级最高</td>
    </tr>
    </tbody>
</table>
<table cellpadding="10" cellspacing="0" border="1">
    <caption>返回的数据</caption>
    <thead>
    <tr>
        <th>参数</th>
        <th>含义</th>
        <th>说明</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>errorCode</td>
        <td>错误码</td>
        <td>为0时，为欢喜的结局</td>
    </tr>
    <tr>
        <td>msg</td>
        <td>提示信息</td>
        <td></td>
    </tr>
    <tr>
        <td>data</td>
        <td>数据</td>
        <td>仅在errorCode=0时，才不为空
            <table  cellpadding="10" cellspacing="0" border="1">
                <tr>
                    <td>list</td><td>列表数据</td>
                </tr>
                <tr>
                    <td>totalPage</td><td>总页数</td>
                </tr>
                <tr>
                    <td>totalRows</td><td>总共有totalRows条数据</td>
                </tr>
            </table>
        </td>
    </tr>
    </tbody>
</table>

<br/>
<p>返回数据：json格式的字符串</p>
<pre>
{
    "errorCode": 0,
    "msg": "获取英雄列表数据成功",
    "data": {
        "list": [
            {
                "ename": "105",
                "cname": "廉颇",
                "title": "正义爆轰",
                "skin_name": "正义爆轰|地狱岩魂",
                "hero_avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/105/105.jpg"
            },
            {
                "ename": "106",
                "cname": "小乔",
                "title": "恋之微风",
                "skin_name": "恋之微风|万圣前夜|天鹅之梦|纯白花嫁|缤纷独角兽",
                "hero_avatar": "https://game.gtimg.cn/images/yxzj/img201606/heroimg/106/106.jpg"
            }
        ],
        "totalPage": 46,
        "totalRows": 91,
    }
}
</pre>
<hr>

<p>英雄详情--GET
    <span class="testUrl" style="margin-left:4%">
        /<span class="controller">Hero</span>/<span>getAll</span>
    </span>
    <a href="/hero/getAll?eName=529" target="_blank" style="margin-left:4%">测试(盘古)</a>
</p>
<table cellpadding="10" cellspacing="0" border="1">
    <caption>参数</caption>
    <thead>
    <tr>
        <th>参数</th>
        <th>是否必需</th>
        <th>参数名</th>
        <th>类型</th>
        <th>解释</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>英雄编号</td>
        <td>必需</td>
        <td>eName</td>
        <td>Integer</td>
        <td></td>
    </tr>
    </tbody>
</table>
<table cellpadding="10" cellspacing="0" border="1">
    <caption>返回的数据</caption>
    <thead>
    <tr>
        <th>参数</th>
        <th>含义</th>
        <th>说明</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>errorCode</td>
        <td>错误码</td>
        <td>为0时，为欢喜的结局</td>
    </tr>
    <tr>
        <td>msg</td>
        <td>提示信息</td>
        <td></td>
    </tr>
    <tr>
        <td>data</td>
        <td>数据</td>
        <td>仅在errorCode=0时，才不为空
            <table  cellpadding="10" cellspacing="0" border="1">
                <tr>
                    <td>main</td><td></td><td>字典</td>
                    <td><a href="/Hero/getDetail?eName=123" target="_blank">查看字段含义</a></td>
                </tr>
                <tr>
                    <td>skin</td><td>皮肤</td><td>列表</td>
                    <td><a href="/Hero/getSkins?eName=123" target="_blank">查看字段含义</a></td>
                </tr>
                <tr>
                    <td>skill</td><td>技能</td><td>列表</td>
                    <td><a href="/Hero/getSkills?eName=123" target="_blank">查看字段含义</a></td>
                </tr>
                <tr>
                    <td>inscriptionMatch</td><td>铭文搭配</td><td>列表</td>
                    <td><a href="/Hero/getInscriptionMatch?eName=123" target="_blank">查看字段含义</a></td>
                </tr>
                <tr>
                    <td>skillsPlusSuggestions</td><td>技能加点建议</td><td>字典</td>
                    <td><a href="/Hero/getSkillsPlusSuggestions?eName=123" target="_blank">查看字段含义</a></td>
                </tr>
                <tr>
                    <td>outfitSuggestions</td><td>出装建议</td><td>列表</td>
                    <td><a href="/Hero/getOutfitSuggestion?eName=123" target="_blank">查看字段含义</a></td>
                </tr>
                <tr>
                    <td>relation</td><td>英雄关系</td><td>列表</td>
                    <td><a href="/Hero/getRelations?eName=123" target="_blank">查看字段含义</a></td>
                </tr>
                <tr>
                    <td>video</td><td>英雄攻略</td><td>列表</td>
                    <td><a href="/Hero/getVideos?eName=123" target="_blank">查看字段含义</a></td>
                </tr>
            </table>
        </td>
    </tr>
    </tbody>
</table>

<br/>
<p>返回数据：json格式的字符串</p>
<pre>

</pre>
<div>
    以下备用接口全部需要传参数 eName（类型：int）--GET
    <p>获取详情  /Hero/getDetail  <a href="/Hero/getDetail?eName=123" target="_blank">查看字段含义</a> </p>
    <p>获取皮肤  /Hero/getSkins <a href="/Hero/getSkins?eName=123" target="_blank">查看字段含义</a></p>
    <p>获取技能  /Hero/getSkills <a href="/Hero/getSkills?eName=123" target="_blank">查看字段含义</a></p>
    <p>获取铭文搭配  /Hero/getInscriptionMatch <a href="/Hero/getInscriptionMatch?eName=123" target="_blank">查看字段含义</a></p>
    <p>获取技能加点  /Hero/getSkillsPlusSuggestions <a href="/Hero/getSkillsPlusSuggestions?eName=123" target="_blank">查看字段含义</a></p>
    <p>获取出装建议  /Hero/getOutfitSuggestion <a href="/Hero/getOutfitSuggestion?eName=123" target="_blank">查看字段含义</a></p>
    <p>获取英雄关系  /Hero/getRelations <a href="/Hero/getRelations?eName=123" target="_blank">查看字段含义</a></p>
    <p>获取视频  /Hero/getVideos <a href="/Hero/getVideos?eName=123" target="_blank">查看字段含义</a></p>
</div>

<hr/>
<p>局内道具单选搜索框
    <span class="testUrl">
        /<span class="controller">pvp</span>/<span>getItemSearchRadios</span>
    </span>
    <a href="" target="_blank" class="test">测试</a>
</p>
<img src="/onRequest/public/images/pvp/itemRadios_2.png" alt=""/>
<img src="/onRequest/public/images/pvp/itemRadios.png" alt=""/>
<p>返回结果：</p>
<pre>
    [
    {
        "id": "1",
        "radio_text": "常规模式",
        "data_type": "0",
        "children": [
            {
                "id": "3",
                "radio_text": "全部",
                "data_parent_type": "0",
                "data_type": "0"
            },
            {
                "id": "5",
                "radio_text": "攻击",
                "data_parent_type": "0",
                "data_type": "1"
            },
</pre>
<hr/>
<p>局内道具列表
    <span class="testUrl">
        /<span class="controller">pvp</span>/<span>getItemList</span>
    </span>
    <a href="/pvp/getItemList?parent_type=0" target="_blank" >测试常规模式</a>
    <a href="/pvp/getItemList?parent_type=1" target="_blank"  style="margin-left:3%">测试边境突围</a>
</p>
<table cellpadding="10" cellspacing="0" border="1">
    <caption>参数</caption>
    <thead>
    <tr>
        <th>参数</th>
        <th>是否必需</th>
        <th>参数名</th>
        <th>类型</th>
        <th>解释</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>页码</td>
        <td>非必需</td>
        <td>p</td>
        <td>Integer</td>
        <td>需要第p页的列表数据</td>
    </tr>
    <tr>
        <td>每页条数</td>
        <td>非必需</td>
        <td>pageSize</td>
        <td>Integer</td>
        <td>每页显示pageSize条数据，默认10条</td>
    </tr>
    <tr>
        <td>常规模式? 边境突围模式?</td>
        <td>非必需</td>
        <td>parent_type</td>
        <td>int</td>
        <td>
            <p>【常规模式】的话，参数值必须是0</p>
            <p>【边境突围模式】的话，参数值推荐为1；</p>
        </td>
    </tr>
    <tr>
        <td>子类型</td>
        <td>非必需</td>
        <td>type</td>
        <td>int</td>
        <td>
            值和解释如下
            <table cellpadding="10" cellspacing="0" border="1">
                <tr>
                    <th>常规模式</th>
                    <td> 0全部</td>
                    <td> 1攻击</td>
                    <td>2法术</td>
                    <td>3防御</td>
                    <td>4移动</td>
                    <td>5打野</td>
                    <td>7辅助</td>
                </tr>
                <tr style="background-color:skyblue">
                    <th>边境突围模式</th>
                    <td>0全部</td>
                    <td>1装备</td>
                    <td>2道具</td>
                    <td>3额外技能</td>
                </tr>
            </table>
            <pre>

        </pre>
        </td>
    </tr>
    </tbody>
</table>
<table cellpadding="10" cellspacing="0" border="1">
    <caption>返回的数据</caption>
    <thead>
    <tr>
        <th>参数</th>
        <th>含义</th>
        <th>说明</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>errorCode</td>
        <td>错误码</td>
        <td>为0时，为欢喜的结局</td>
    </tr>
    <tr>
        <td>msg</td>
        <td>提示信息</td>
        <td></td>
    </tr>
    <tr>
        <td>data</td>
        <td>数据</td>
        <td>仅在errorCode=0时，才不为空
            <table  cellpadding="10" cellspacing="0" border="1">
                <tr>
                    <td>list</td><td>列表数据</td>
                </tr>
                <tr>
                    <td>totalPage</td><td>总页数</td>
                </tr>
                <tr>
                    <td>totalRows</td><td>总共有totalRows条数据</td>
                </tr>
            </table>
        </td>
    </tr>
    </tbody>
</table>
<p>返回数据：</p>
<table cellpadding="0" cellspacing="0" border="1">
    <tr>
        <th>常规模式</th>
        <th>边境突围模式</th>
    </tr>
    <tr>
        <td>
            <pre>
{
    "errorCode": 0,
    "msg": "获取列表数据成功",
    "data": {
        "list": [
            {
                "des1": [
                    "+20物理攻击"
                ],
                "item_id": "1111",
                "item_name": "铁剑",
                "item_type": "1",
                "price": "150",
                "total_price": "250",
                "item_img": "https://game.gtimg.cn/images/yxzj/img201606/itemimg/1111.jpg"
            },
            {
                "des1": [
                    "+10%攻击速度 "
                ],
                "item_id": "1112",
                "item_name": "匕首",
                "item_type": "1",
                "price": "174",
                "total_price": "290",
                "item_img": "https://game.gtimg.cn/images/yxzj/img201606/itemimg/1112.jpg"
            }
        ],
        "totalPage": 48,
        "totalRows": 95,
    }
}
</pre>
        </td>
        <td>
            <pre>
                {
    "errorCode": 0,
    "msg": "获取列表数据成功",
    "data": {
        "list": [
            {
                "des1": [
                    "+250攻击"
                ],
                "des2": "唯一被动:【破军】:目标生命低于50%时伤害提高30%",
                "item_id": "2000",
                "item_level": "4级",
                "item_name": "砂之破军",
                "item_type": "1",
                "item_img": "https://game.gtimg.cn/images/yxzj/img201606/itemimg/2000.jpg"
            },
            {
                "des1": [
                    "+400法攻",
                    "+600最大生命"
                ],
                "des2": "唯一被动:【刻印】：增加1400点最大生命值",
                "item_id": "2001",
                "item_level": "4级",
                "item_name": "贤者之书",
                "item_type": "1",
                "item_img": "https://game.gtimg.cn/images/yxzj/img201606/itemimg/2001.jpg"
            }
        ],
        "totalPage": 6,
        "totalRows": 11,
    }
}
            </pre>
        </td>
    </tr>
</table>
<hr/>
<p>召唤师列表
    <span class="testUrl">
        /<span class="controller">pvp</span>/<span>getSummonerList</span>
    </span>
    <a href="" target="_blank" class="test">测试</a>
</p>
<pre>
[
    {
        "id": "1",
        "summoner_description": "30秒CD：对身边的野怪和小兵造成真实伤害并眩晕1秒",
        "summoner_id": "80104",
        "summoner_name": "惩击",
        "summoner_rank": "LV.1解锁",
        "summoner_img": "https://game.gtimg.cn/images/yxzj/img201606/summoner/80104.jpg",
        "big_img": "https://game.gtimg.cn/images/yxzj/img201606/summoner/80104-big.jpg"
    },
    {
        "id": "2",
        "summoner_description": "90秒CD：立即对身边敌军英雄造成其已损失生命值14%的真实伤害",
        "summoner_id": "80108",
        "summoner_name": "终结",
        "summoner_rank": "LV.3解锁",
        "summoner_img": "https://game.gtimg.cn/images/yxzj/img201606/summoner/80108.jpg",
        "big_img": "https://game.gtimg.cn/images/yxzj/img201606/summoner/80108-big.jpg"
    },
</pre>
<hr/>

<p>搜索英雄名称、局内道具名称或者召唤师技能名称 /pvp/searchAll
    <a href="/pvp/searchAll?keyword=星" target="_blank" style="margin-left:4%">搜索“星”</a>
</p>
<table cellpadding="10" cellspacing="0" border="1">
    <caption>参数</caption>
    <thead>
    <tr>
        <th>参数</th>
        <th>是否必需</th>
        <th>参数名</th>
        <th>类型</th>
        <th>解释</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>关键词</td>
        <td>必需</td>
        <td>keyword</td>
        <td>string</td>
        <td>目前不考虑分页</td>
    </tr>
    </tbody>
</table>
<pre>
{
    "errorCode": 0,
    "msg": "获取数据成功",
    "data": {
        "hero": [],//英雄
        "item_0": [],//局内道具--常规模式
        "item_1": [],//局内道具--边境突围模式
        "summoner": []// 召唤师技能
    }
}
</pre>
<hr/>

<p>视频列表 /video/getList
    <a href="/video/getList?is_hot=0" target="_blank" style="margin-left:4%">全部视频</a>
    <a href="/video/getList?is_hot=1&pageSize=5" target="_blank" style="margin-left:4%">热播视频</a>
</p>
<table cellpadding="10" cellspacing="0" border="1">
    <caption>参数</caption>
    <thead>
    <tr>
        <th>参数</th>
        <th>是否必需</th>
        <th>参数名</th>
        <th>类型</th>
        <th>解释</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>页码</td>
        <td>非必需</td>
        <td>p</td>
        <td>Integer</td>
        <td>需要第p页的列表数据。热播不需要此参数</td>
    </tr>
    <tr>
        <td>每页条数</td>
        <td>非必需</td>
        <td>pageSize</td>
        <td>Integer</td>
        <td>每页显示pageSize条数据，默认10条。<br/>
            热播也需要此参数，用以指定需要多少条，默认5条。
        </td>
    </tr>
    <tr>
        <td>热播? 全部?</td>
        <td>非必需</td>
        <td>is_hot</td>
        <td>int</td>
        <td>
            <p>【热播】的话，参数值必须大于0</p>
        </td>
    </tr>
    </tbody>
</table>
<pre>
    列表数据其中一条：
    <!--url  视频完整链接-->
    vid  视频id
    title  标题
    link  链接
    img_src  封面图
    detail_url  详情链接
    author  作者名称
    duration 视频时长
    counts  播放量
    upload_time 视频上传时间
    introduction  介绍
    like_count  点赞数
    game_name  游戏类型，比如“王者荣耀”
    author_count  作者id
    author_src 作者头像
</pre>
<p>视频列表 /video/getInfoWithRelatedVideos
    <a href="/video/getInfoWithRelatedVideos?id=104857909" target="_blank" style="margin-left:4%">详情+推荐列表</a>
</p>
<table cellpadding="10" cellspacing="0" border="1">
    <caption>参数</caption>
    <thead>
    <tr>
        <th>参数</th>
        <th>是否必需</th>
        <th>参数名</th>
        <th>类型</th>
        <th>解释</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>页码</td>
        <td>必需</td>
        <td>id</td>
        <td>Integer</td>
        <td>视频记录的vid</td>
    </tr>
    </tbody>
</table>

<table cellpadding="10" cellspacing="0" border="1">
    <caption>
        <p>视频列表 /video/getMostHotVideos
            <a href="/video/getMostHotVideos?pageSize=2" target="_blank" style="margin-left:4%">最热视频</a>
        </p>
    </caption>
    <thead>
    <tr>
        <th>参数</th>
        <th>是否必需</th>
        <th>参数名</th>
        <th>类型</th>
        <th>解释</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>需要的记录数量</td>
        <td>非必需</td>
        <td>pageSize</td>
        <td>Integer</td>
        <td>用以指定需要多少条记录。默认5条</td>
    </tr>
    </tbody>
</table>
<pre>
    {
    "errorCode": 0,
    "msg": "获取列表数据成功",
    "data": {
        "list": {
            "0": {
                "vid": "128117555",
                "title": "穿越火线：一局出现两个终结者，这游戏还怎么玩？",
                "link": "http://huya-w10.huya.com/1909/128117555/yuanhua/a09417657226d6d4792fc32b83489964.mp4",
                "img_src": "http://v-huya-img.huya.com/1909/128117555/99-460x268.jpg",
                "detail_url": "http://v.huya.com/play/128117555.html",
                "author": "玩命解说",
                "duration": "05:41",
                "counts": "999",
                "upload_time": "2019-02-28 15:35:10",
                "introduction": "玩命QQ：2481344245",
                "like_count": "3",
                "game_name": "穿越火线",
                "author_count": "10761",
                "author_src": "http://huyaimg.msstatic.com/avatar/1075/18/627970460e2ae623c8758f475820c3_180_135.jpg?1517925692"
            },
        }
    }
}
</pre>

<hr/>
<div id="user_mod">
    <table cellpadding="10" cellspacing="0" border="1">
        <caption>返回的数据</caption>
        <thead>
        <tr>
            <th>参数</th>
            <th>含义</th>
            <th>说明</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>errorCode</td>
            <td>错误码</td>
            <td>为0时，为欢喜的结局</td>
        </tr>
        <tr>
            <td>msg</td>
            <td>提示信息</td>
            <td></td>
        </tr>
        <tr>
            <td>data</td>
            <td>数据</td>
            <td>仅在errorCode=0时，才不为空</td>
        </tr>
        <tr>
            <td>session_id</td>
            <td>会话凭证</td>
            <td>只有登录接口提供此项，登录成功时提供</td>
        </tr>
        </tbody>
    </table>
    <p>注册--POST--
        <span class="testUrl">
            /<span class="controller">user</span>/<span>register</span>
        </span>
    </p>
    <table cellpadding="10" cellspacing="0" border="1">
        <thead>
        <tr>
            <th>参数</th>
            <th>是否必需</th>
            <th>参数名</th>
            <th>类型</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>用户名</td>
            <td>必需</td>
            <td>userName</td>
            <td>String</td>
        </tr>
        <tr>
            <td>密码</td>
            <td>必需</td>
            <td>password</td>
            <td>String</td>
        </tr>
        </tbody>
    </table>
    <p>用户名是否唯一--POST--
        <span class="testUrl">
            /<span class="controller">user</span>/<span>isUniqueUserName</span>
        </span>
    </p>
    <table cellpadding="10" cellspacing="0" border="1">
        <thead>
        <tr>
            <th>参数</th>
            <th>是否必需</th>
            <th>参数名</th>
            <th>类型</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>用户名</td>
            <td>必需</td>
            <td>userName</td>
            <td>String</td>
        </tr>
        </tbody>
    </table>
    <p>登录--POST--
        <span class="testUrl">
            /<span class="controller">user</span>/<span>login</span>
        </span>
    </p>
    <table cellpadding="10" cellspacing="0" border="1">
        <thead>
        <tr>
            <th>参数</th>
            <th>是否必需</th>
            <th>参数名</th>
            <th>类型</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>用户名</td>
            <td>必需</td>
            <td>userName</td>
            <td>String</td>
        </tr>
        <tr>
            <td>密码</td>
            <td>必需</td>
            <td>password</td>
            <td>String</td>
        </tr>
        </tbody>
    </table>
    <label for="userName">用户名</label><input type="text" id="userName"/>
    <label for="password">密码</label><input type="text" id="password"/>
    <button type="button" onclick="obj.register(this)" data-url="">注册</button>
    <button type="button" onclick="obj.isUnique(this)" data-url="">用户名是否唯一</button>
    <button type="button" onclick="obj.login(this)" data-url="">登录</button>
    <hr/>

    <p>
        获取用户信息
        <span class="testUrl">
            /<span class="controller">user</span>/<span>getUserInfo</span>
        </span>
    </p>
    用户名:<span id="userInfo_userName"></span>
    <img src="" alt="">
    <button type="button" onclick="obj.getUserInfo(this)" data-url="">获取用户信息</button>
    <hr/>

    <p>上传头像
        <span class="testUrl">
            /<span class="controller">user</span>/<span>uploadAvatar</span>
        </span>
    </p>
    <table cellpadding="10" cellspacing="0" border="1">
        <thead>
        <tr>
            <th>参数</th>
            <th>是否必需</th>
            <th>参数名</th>
            <th>类型</th>
            <th>解释</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td></td>
            <td>必需</td>
            <td>avatar</td>
            <td>File</td>
            <td></td>
        </tr>
        </tbody>
    </table>
    <form action="/user/uploadAvatar" method="post" enctype="multipart/form-data" style="display: inline-block">
        <label for="avatar">上传头像</label><input type="file" id="avatar" name="avatar"/>
        <input type="submit" value="提交表单">
    </form>
    <button type="button" onclick="obj.uploadAvatar(this)" data-url="">ajax上传头像</button>
    <hr/>

    <p>
        修改用户资料
        <span class="testUrl">
            /<span class="controller">user</span>/<span>modifyUserInfo</span>
        </span>
    </p>
    <table cellpadding="10" cellspacing="0" border="1">
        <caption>只有成功修改用户资料，数据表中的头像地址才会变化</caption>
        <thead>
        <tr>
            <th>参数</th>
            <th>是否必需</th>
            <th>参数名</th>
            <th>类型</th>
            <th>解释</th>
        </tr>
        </thead>
        <tbody>
        <tr>
            <td>头像图片的文件名</td>
            <td>非必需</td>
            <td>avatar</td>
            <td>string</td>
            <td>例如:aspsds8dfkjd6.jpg。考虑到可能没有上传图片</td>
        </tr>
        <tr>
            <td>年纪</td>
            <td>非必需</td>
            <td>age</td>
            <td>int</td>
            <td>例如:34</td>
        </tr>
        <tr>
            <td>性别</td>
            <td>非必需</td>
            <td>sex</td>
            <td>string</td>
            <td>例如:男</td>
        </tr>
        <tr>
            <td>昵称</td>
            <td>非必需</td>
            <td>nickname</td>
            <td>string</td>
            <td>例如:飞飞小坏蛋</td>
        </tr>
        <tr>
            <td>个性签名</td>
            <td>非必需</td>
            <td>signature</td>
            <td>string</td>
            <td>例如:mongDB可以远程访问了，嘻嘻...</td>
        </tr>
        </tbody>
    </table>
    <label for="avatarImg">头像</label><input type="image" value="" id="avatarImg" alt="" src=""/>
    <label for="age">年纪</label><input type="number" id="age"  value="28"/>
    <label for="sex">性别</label><input type="text"  id="sex" value="男" />
    <label for="nickname">昵称</label><input type="text"  id="nickname" value="男" />
    <br/>
    <div style="margin-top:1%;">
        <label for="signature">个性签名</label>
        <textarea id="signature">我的个性签名</textarea>
    </div>
    <button type="button" onclick="obj.modifyUserInfo(this)" data-url="/user/modifyUserInfo">修改用户资料</button>
    <hr/>
</div>
<hr/>
<p>进入英雄详情页后，点赞和取消点赞
    <span class="testUrl">
        /<span class="controller">user</span>/<span>likeTheHeroOrNot</span>
    </span>
</p>
<label for="heroId">英雄id</label><input type="number" id="heroId" value="529">
<button type="button" onclick="obj.likeTheHeroOrNot(1)">点赞</button>
<button type="button" style="margin-left:2%" onclick="obj.likeTheHeroOrNot(-1)">取消点赞</button>
<table cellpadding="10" cellspacing="0" border="1">
    <caption>参数</caption>
    <thead>
    <tr>
        <th>参数</th>
        <th>是否必需</th>
        <th>参数名</th>
        <th>类型</th>
        <th>解释</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <td>英雄编号</td>
        <td>必需</td>
        <td>eName</td>
        <td>Integer</td>
        <td></td>
    </tr>
    <tr>
        <td>点赞？取消点赞</td>
        <td>必需</td>
        <td>like</td>
        <td>Integer</td>
        <td>1:点赞；<br/>-1：取消点赞</td>
    </tr>
    </tbody>
</table>
<div>
    返回的数据：
    <pre>
      {
        "errorCode": 0,
        "msg": "点赞成功",
        "data": []
    }
    </pre>
</div>
<hr/>
<div id="dialog" class="dialog">
    <button type="button" class="dialogCloseBtn" onclick="obj.closeDialog()">关闭</button>
    <div id="ajaxError" class="dialogContainer">ajax错误</div>
</div>
<div id="ajaxSuccess"></div>
<script>
    class Test{
        init()
        {
            this.divObj = $("#ajaxError");
            this.userInfo = {};
            this.diaLogObj = $("#dialog");
        }
        triggerAjax(config)
        {
            let _this = this;
            //config.data = config.data ? {}: config.data;
            $.ajax({
                url : config.url,
                type: config.type,
                data: config.data,
                dataType : "json",
                beforeSend:function(xhr)
                {
                    _this.divObj.html('');
                    //console.log('typeof config.beforeSend',typeof config.beforeSend);
                    if( typeof config.beforeSend === "function")
                    {
                        //console.log('运行beforeSend');
                        config.beforeSend(xhr);
                    }
                },
                complete:function()
                {

                },
                success:function(result)
                {
                    if( typeof config.success === "function")
                    {
                        config.success(result);
                    }
                },
                error:function(xhr,status,error)
                {
                    _this.divObj.html(xhr.responseText);
                    _this.showDialog();
                }
            });
        }
        showDialog()
        {
            this.diaLogObj.attr('class','dialog show');
        }
        closeDialog()
        {
            this.diaLogObj.attr('class','dialog');
        }
        static getUserName()
        {
            return $("#userName").val();
        }
        static getPassword()
        {
            return $("#password").val();
        }
        register(me)
        {
            this.triggerAjax({
                url :me.getAttribute('data-url'),
                type: 'POST',
                data :{
                    userName:Test.getUserName(),
                    password:Test.getPassword(),
                },
                success:function (result) {
                    alert(result.msg);
                }
            });
        }
        isUnique(me)
        {
            this.triggerAjax({
                url :me.getAttribute('data-url'),
                type: 'POST',
                data :{
                    userName:Test.getUserName(),
                },
                success:function (result) {
                    alert(result.msg);
                }
            });
        }
        login(me)
        {
            let _this = this;
            this.triggerAjax({
                url :me.getAttribute('data-url'),
                type: 'POST',
                data :{
                    userName:Test.getUserName(),
                    password:Test.getPassword(),
                },
                success:function (result) {
                    alert(result.msg);
                    _this.userInfo = result.data;
                    document.cookie="PHPSESSID=" + result.session_id;
                    sessionStorage.setItem('sessionId',result.session_id);
                }
            });
        }
        likeTheHeroOrNot(like)
        {
            let _this = this;
            this.triggerAjax({
                url :'/user/likeTheHeroOrNot',
                type: "GET",
                data :{
                    eName : $("#heroId").val(),
                    like: like
                },
                beforeSend:function(xhr){
                    let sess_id = sessionStorage.getItem('sessionId');
                    console.log('sess_id',sess_id);
                    //xhr.setRequestHeader("Cookie","PHPSESSID=" + sess_id);
                },
                success:function (result) {
                    alert(result.msg);
                }
            });
        }
        getUserInfo(me)
        {
            let _this = this;
            this.triggerAjax({
                url :me.getAttribute('data-url'),
                type: 'POST',
                data :{
                    id:  _this.userInfo.id,
                },
                success:function (result) {
                    alert(result.msg);
                }
            });
        }
        uploadAvatar(me)
        {
            let _this = this;
            ajaxUploadFile({
                inputObj: document.getElementById("avatar"),
                inputName:'avatar',
                data :{
                    hello:'world'
                },
                url:me.getAttribute('data-url'),
                uploadingProgressFunc: function(percentComplete) {},
                handling:function(result){},
                success:function(apiData)
                {
                    console.log('success-apiData',apiData);
                    if( apiData.errorCode > 0)
                    {
                        alert(apiData.msg);
                        return;
                    }
                    let data = apiData.data;
                    if( data.successFiles )
                    {
                        let img = data.successFiles[0];
                        let obj = $("#avatarImg");
                        obj.attr('src', data.path + img);
                        obj.val(img);
                    }
                },
                error:function(response)
                {
                    _this.divObj.html(response);
                    _this.showDialog();
                },
            });
        }
        modifyUserInfo(me)
        {
            let _this = this;
            this.triggerAjax({
                url :me.getAttribute('data-url'),
                type: 'POST',
                data :{
                    avatar:$('#avatarImg').val(),
                    age:$('#age').val(),
                    sex:$('#sex').val(),
                    nickname:$('#nickname').val(),
                    signature:$('#signature').val(),
                },
                success:function (result) {
                    alert(result.msg);
                    _this.userInfo = result.data;
                }
            });
        }
    }
     let obj = new Test();
    obj.init();
    $(document).ready(function(){
        let arr = $("a.test");
        //console.log('a_arr=',a_arr);
        let href = '', ctrl ='', method = '';
        let spanObj = null;
        arr.each(function(index,currentItem){
            //console.log('currentItem=',currentItem);
            spanObj = $(currentItem).prev();
            ctrl  = spanObj.children().eq(0).text();
            method  = spanObj.children().eq(1).text();
            href = `/${ctrl}/${method}`;
            $(currentItem).attr("href",href)
        });
        //
        let userMod =  $("#user_mod");
        arr = userMod.find("span.testUrl");
        console.log('arr=',arr);
        arr.each(function(index,currentItem){
            spanObj = $(currentItem);
            ctrl  = spanObj.children().eq(0).text();
            method  = spanObj.children().eq(1).text();
            href = `/${ctrl}/${method}`;
            console.log("href=",href);
            spanObj.parent().siblings("button").eq(index).attr('data-url',href);
        });
    });
</script>
</body>
</html>
